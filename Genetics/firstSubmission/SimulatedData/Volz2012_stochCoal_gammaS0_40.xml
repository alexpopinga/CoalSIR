<beast version='2.0'
       namespace='import beast.math.distributions.Prior:beast.util.TreeParser:beast.phylodynamics.epidemiology:master.beast:beast.core:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood:beast.core.parameter:beast.phylodynamics.epidemiology:beast.evolution.tree:beast.evolution.alignment'>

    <tree spec="beast.util.TreeParser" id="tree" adjustTipHeights="false" newick="((1:1.7916306512431355,((((((52:6.822378414348043,((89:7.412236164228187,(((76:3.1987062184863966,125:8.085793246206396)156:0.9854571638980882,131:10.450150777414486)173:0.6029912600800245,91:5.887200289464509)183:1.6458436640636762)202:1.6874139166842745,9:0.3372429697124595)228:1.2017869251355826)244:1.5558262207333406,(49:3.4050199670419374,30:0.8454214456419393)195:4.838080051339446)257:0.6805467885797363,((80:8.194331923715422,103:10.688046605115423)226:2.9668435293671394,((53:3.434667300669508,25:8.235665695082162E-4)192:0.883231547443156,87:7.344335224812664)206:4.305292167469897)258:0.5406148098785586)265:0.24160381996709646,((17:3.6577445873556726,18:3.705306557555673)252:0.9440894429119169,(7:0.5090975758311451,45:5.458306205331144)239:2.423294137836443)259:0.6042372556606281)268:1.0281476701062253,(((((20:0.3431811721049236,65:5.3594435013049235)205:1.534755212019725,19:1.623830799224649)230:2.352384443551532,(((99:5.5718888545180505,129:9.46761228430805)164:3.4275400940879095,29:1.7464504442059585)210:3.3383151364677275,(104:11.001971391092361,(11:0.4965504951043265,101:9.898566529704325)219:0.7524886955880348)232:2.0369053832813258)253:0.1195085542024934)256:1.243412304343984,(((13:0.5918733315192526,141:20.331172118819254)218:3.936196924382795,4:0.4497530439020494)263:0.16116882810177913,((10:0.5460329394302725,(94:5.05787944612733,48:1.01642653542733)168:3.973386007902942)220:1.971867441168321,47:6.757440008498593)248:1.910109716005234)266:0.09178576601633637)267:0.5713553887005993,(((138:14.351076143635455,(79:1.26334171885693,(114:4.4482203655258115,106:3.7279976339358107)146:0.08356042622111914)147:3.586719653698525)181:4.371537243622846,(16:1.354646180421657,(31:2.8823089722315096,69:7.05216161683151)224:0.1113869852901459)225:1.1056817897566447)241:2.0930856200908394,26:5.5526895949691415)260:1.1372667693516227)271:0.4949765518136786)272:0.9676468543619663,((14:0.6649872295345105,111:10.71312803190451)217:0.2642460171736012,98:9.681295951008112)221:6.005573104588297)274:1.5469700260467256)280:0.6968233801060286,((((((123:4.0015460786469115,(127:3.8124786911864748,109:1.654958520876475)143:0.5796497599104367)144:5.987997270673727,38:1.3450331892706373)188:3.4149378189657256,(((37:0.603609752057114,(122:8.165829132871043,50:0.9454418104310438)163:1.0156742289260698)179:2.46072037595912,105:9.720753681116234)208:1.1310283304798894,8:0.15903833679612234)231:0.3583545523402414)235:0.3102622375748716,12:1.7561470708112346)240:5.171272982262813,((5:0.8332044588963825,((((119:10.330510194849936,(67:3.346143180515959,((85:3.9609637950424332,(140:14.578005409120221,139:12.820632094583221)154:0.974379116379211)159:0.24214194783405674,115:7.197187870756489)166:0.6504669694394707)175:1.802020878403976)196:2.009332510317982,(130:13.281287961426077,(27:0.5418369625999553,112:9.409007086339956)198:1.1659054261961224)213:0.8117522037418397)229:1.4870842829899367,(117:9.439389802914661,33:0.5693344764046628)190:4.181441836023193)245:0.07144268012827126,(21:1.285933058536049,((77:3.7162130519244663,(68:0.5476000164212174,81:1.6278035287212163)150:2.1981415811032505)165:2.814569605517409,24:0.6012529575418775)203:0.9585080797941714)214:2.2775821005200783)246:2.732103402571795E-4)247:2.5229418074875127,(((118:5.461637031635714,110:4.465024203775714)148:7.922125190898406,(107:11.42279705344527,((72:7.058130273956635,(136:16.003888325035746,(46:0.9531992342423976,124:9.091477016492396)174:3.19752305618335)215:0.0071088180308898075)216:1.096611076535865,15:1.8032343406925015)233:0.21916860925276893)237:0.48548238790884923)243:2.3196064314512306,(((55:3.3294809947189634,44:2.1267303863189646)189:1.1299920429180794,(41:1.6198111423423107,42:1.6341074686423092)187:1.451802870394733)204:0.4878021522226561,((78:4.523548838716222,102:6.79403220291622)176:2.4781558433003603,(((60:2.086086633782891,57:1.9312149715828912)170:0.9793816095412637,36:0.796326123224155)184:0.7424398426094676,((82:1.7259674308228963,108:4.423019635692896)149:3.1234316270645692,35:0.25218396608746474)178:1.1123870907461573)191:1.2942594483829595)207:0.17610322704311798)211:4.491720355245651)264:0.6715155528785459)270:1.8007765220901533)277:1.596255043711274,((0:0.2537571282767068,((((113:8.443695519209811,34:0.5412663160098106)186:6.340955357340384,(58:9.439183111067813,(((64:2.4564085597387937,(86:0.2188812973027101,96:0.9432086213027109)145:4.346445112336083)171:5.81680857021847,(66:7.546276189416993,(((126:10.892234591169757,84:6.444618884789756)193:0.446637176680845,28:0.9669103737706024)200:0.0084156340032564,((95:3.7082980165799473,61:0.7716425567799483)153:3.840389094022104,54:4.109309356402052)199:0.15046317447180613)201:2.3561154293431343)238:0.9998334313402708)249:0.6622662518610767,(23:4.5361403017045845,((((75:3.338751201806815,133:10.634293244976813)158:0.4540895557065596,71:3.391632474813374)169:4.000158151899061,(100:9.361638541608693,(43:0.07364950237780477,83:3.866934818877805)160:3.8117323674308885)212:0.5281875623037422)222:0.887564616829831,(120:12.937413375296865,(((32:1.1680362853508797,(116:6.444759606648708,90:3.7157775123387076)155:3.4787046226121703)197:0.9030633510675941,(62:3.100493459049023,97:6.369077874649022)180:2.3311621299694494)209:1.0226672431959614,((((88:4.310276981742449,56:1.534463038242448)161:1.2384392882060027,(137:11.163702611365368,92:3.4386079155653686)152:2.5047669393830834)182:0.29998059635622454,(63:0.14803033271399357,74:1.690740406013994)151:3.330381416690683)185:0.9677765758621142,((132:2.7661586206928783,128:1.138211248292878)142:8.895707900564458,59:2.6428575901673366)177:1.5846434425994538)194:2.0417940465476434)227:0.4552068258524322)234:0.17197263797540074)236:1.7005964430623166)254:0.024171492813756856)255:0.9444714999494721)261:0.036664706482383735)262:2.4271456795816775,2:0.8105520709318732)275:0.04002415772301049,(((40:0.04759454390442741,93:4.796207849204428)162:0.5842730279421815,(39:0.07832320162477657,121:8.144815576774779)167:0.4297084276218328)172:5.98891097323499,22:4.2280784830816)251:3.733177579373283)276:1.1615863887218225)278:0.022097452501164128,((6:1.587978599579749,73:9.634154050879749)250:3.180415422158255,(3:0.5831187393336634,((135:16.355172289187994,(51:0.8453173539483263,134:11.598034730198325)157:4.484681184699667)223:1.3381170552564114,70:8.675587527804405)242:2.69883631932926)269:1.1852273464043392)273:2.0015002330398666)279:0.5584822073074527)281:0.41651957696383946)282:0.0;"/>

  <state>
        <stateNode spec="RealParameter" id="volz.n_S0" value="999"/>
        <stateNode spec="RealParameter" id="volz.beta" value="0.00075"/>
        <stateNode spec="RealParameter" id="volz.gamma" value="0.30"/>
        <stateNode spec="RealParameter" id="volz.origin" value="28.7980958383"/>
    </state>

    <!-- Parameter priors -->
    <input spec='CompoundDistribution' id='parameterPriors'>
        <distribution spec='beast.math.distributions.Prior' x="@volz.n_S0">
            <distr spec='LogNormalDistributionModel' M="2" S="2"/>
        </distribution>
        <distribution spec='beast.math.distributions.Prior' x="@volz.beta">
            <distr spec="LogNormalDistributionModel"  M="-2" S="2"/>
        </distribution>
        <distribution spec='beast.math.distributions.Prior' x="@volz.gamma">
            <distr spec='LogNormalDistributionModel' M="0" S="2"/>
        </distribution>
        <distribution spec='beast.math.distributions.Prior' x="@volz.origin">
            <distr spec="LogNormalDistributionModel"  M="0" S="2"/>
        </distribution>
    </input>


    <run spec="MCMC" id="mcmc" chainLength="200000">

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution id="coalescent" spec="Coalescent">
                <treeIntervals spec='TreeIntervals' id='treeIntervals'>
                    <tree idref="tree"/>
                </treeIntervals>
                
                <populationModel spec="SIRPopulationFunction" id='popFunc'>
                    <volzSIR spec="DeterministicSIR" id="volzSIR" integrationStepCount="1001">
                        <beta idref="volz.beta"/>
                        <gamma idref="volz.gamma"/>
                        <n_S0 idref="volz.n_S0"/>
                        <origin idref="volz.origin"/>
                    </volzSIR>
                </populationModel>
                
            </distribution>
        </distribution>


    <!-- OPERATORS! :D -->

      <operator id='S0' spec='ScaleOperator' scaleFactor="0.8" weight="1">
          <parameter idref="volz.n_S0"/>
      </operator>

      <!--<operator id='beta' spec='ScaleOperator' scaleFactor="0.8" weight="1">
          <parameter idref="volz.beta"/>
      </operator>-->

      <operator id='gamma' spec='ScaleOperator' scaleFactor="0.8" weight="1">
          <parameter idref="volz.gamma"/>
       </operator>

        <operator id='upDown' spec='UpDownOperator' scaleFactor="0.8" weight="1">
            <!--<up idref="volz.beta"/>-->
            <up idref="volz.gamma"/>
            <up idref="volz.n_S0"/>
        </operator>


        <logger logEvery="1000" fileName="Volz2012_stochCoal_gammaS0_40.log">
   	        <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="volz.n_S0"/>
            <log idref="volz.beta"/>
            <log idref="volz.gamma"/>
            <log idref="volz.origin"/>
            <log idref="volzSIR"/>
        </logger>

        <logger logEvery="1000">
            <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="volz.n_S0"/>
            <log idref="volz.beta"/>
            <log idref="volz.gamma"/>
            <log idref="volz.origin"/>
            <log idref="volzSIR"/>
        </logger>

    </run>

</beast>

