<beast version='2.0'
       namespace='import beast.math.distributions.Prior:beast.util.TreeParser:beast.phylodynamics.epidemiology:master.beast:beast.core:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood:beast.core.parameter:beast.phylodynamics.epidemiology:beast.evolution.tree:beast.evolution.alignment'>

    <tree spec="beast.util.TreeParser" id="tree" adjustTipHeights="false" newick="((1:0.5641670563653705,(((((8:0.8830356196318476,((86:3.3107188795305476,133:10.174324983430552)185:6.054897567434558,36:5.09566513896511)260:1.4519613168667362)274:0.5465924337297565,17:5.393990033261602)280:0.7648012358196823,(((((((((116:2.6810223122476735,123:3.5346915882476715)152:6.5995999812861115,((115:2.2030834892733857,130:4.448389690173386)151:3.1756994190870955,93:2.1242462881604816)164:3.668582234673302)198:0.06526754909937438,106:7.21290122083316)201:0.7563483529998862,35:1.1962017123330426)208:1.2144734446387346,29:1.7322934425717804)225:1.3223583245562267,32:3.359742664028005)245:3.131748957946442,(((103:11.24357125514852,((108:9.115200584387551,14:0.12677293278755286)219:0.9830120185407552,(68:3.417573489435391,111:7.907959998635391)197:3.0096300135929184)234:1.782022665220211)259:0.5036478052292992,(16:2.680244094171705,(12:1.3190733836555424,33:3.916987904255542)248:0.41096801491615764)255:0.9728800554061152)265:0.20876653634346098,59:8.178424874821282)267:1.3082779537531692)279:0.21260052290723763,((((77:1.0589824061963427,87:1.3250782852963425)165:8.641904737265499,(10:0.030314739916917688,13:1.2142132717169218)243:1.958595269644924)269:0.6906300949075899,(38:5.675231523150259,((((141:12.098754398376808,(109:3.1680487246306264,127:6.163981349630625)160:1.167073551346185)171:0.015131275154587343,120:6.473686931131397)172:4.983442098881866,(62:4.020586343481057,(66:2.6423408709163283,97:4.970788225316326)188:1.8958823184647287)207:1.105081813532209)223:0.6349337533959698,34:2.8946785502092354)231:2.6424535054410256)268:0.7453061750191736)272:0.33397401001801086,(((26:2.151266927894177,(113:7.3732417126640435,139:12.785678084364044)183:4.430760497630132)237:0.7198487727161336,(83:7.440735395193613,(49:4.065398622259451,74:5.8892326043594565)221:1.0623732983341583)236:0.7488895092166956)249:1.2753445598801534,((18:3.5322347381578467,((81:4.953786826512449,(112:6.922476895432144,(142:10.8993108490528,95:0.8293605150528016)157:3.7120505230793412)186:1.7169456042803048)203:0.6348198608265108,28:0.3303826499389615)211:3.777525862818891)261:0.08330904213015344,((19:1.153157583627383,((43:1.1562043059887515,(((73:0.009571455559573394,129:6.897676354659573)161:1.7017583062382826,61:0.7740226473978566)178:1.486768433181176,143:18.855278927379032)191:0.395984334009718)195:2.635211702414189,20:1.0435313744029386)226:0.2376073657244433)227:0.8426705635173732,24:2.2017633343447542)241:1.6357009482432474)262:0.006123865102459547)263:1.4020728924969816)275:0.4232247142942427)281:0.2583212370162542,(((((126:8.532587170763485,52:0.7468735106634838)181:3.5664528184614213,(30:0.23958141622297546,(((117:6.182632067430337,(72:0.6865822583806178,76:1.0423158106806198)167:0.038537363549721704)169:1.5096209848247,65:2.001027671255038)182:0.9583220096779996,40:0.7442634501330403)192:1.2054656920899376)204:1.2034064935019302)218:2.511586362350968,15:2.773233707275871)257:1.6195533176329278,(((79:4.030169469954579,(54:0.10269880272038989,(135:9.24569805410497,((146:20.46455633311237,124:4.929663114112369)154:0.20655235454805165,136:7.552959411460421)156:1.9499156496445522)168:0.682324788515416)176:2.0626932368341926)196:4.304160000436404,80:8.397178814690982)251:0.31427246151914545,(51:5.311284365271021,134:15.089344232471024)235:1.3522981470391073)256:1.6766137379986716)270:1.0335862553741464,(((21:2.900143682141362,(((56:3.6943422745658694,63:4.2480710545658695)209:0.7019221862200666,31:1.6137835472859337)216:1.7643211394469702,(102:8.49923661758216,(118:10.64965737767206,37:1.726773894672057)213:0.5074278900100992)220:1.650077464850746)246:0.5750689375084548)254:2.4180869004934706,(48:3.2169860985468475,(147:34.62840014551047,78:1.647650933710466)174:3.7775256961363795)210:5.432147796087982)277:0.059134776648789966,((((100:3.9938490577421,91:2.9924902200421)179:0.8382789174108254,42:0.1276605026529296)184:2.0862520786357877,47:2.815273718288715)206:2.4980754481517877,(41:2.6621700077811283,98:7.192075987681125)212:1.9627284247593764)239:3.3801768399431182)278:0.3910641223993281)283:0.10013841361499232)284:0.488453516683343)286:1.5075683783491698,((4:0.34265515334779195,((((67:0.4888004136192876,71:0.6660110071192875)166:6.373235805637208,(((50:2.8471626615913266,(90:5.169328658833805,(101:6.481356653289911,96:5.998155653789908)200:0.10947271064389241)202:0.4033761938575253)205:0.9500954407289939,60:4.510906863920319)214:0.16345209197157828,55:4.357063354591901)215:1.4895086020645962)240:3.657407380287374,((((121:6.021769423095726,140:10.960335863795727)163:3.142571524371256,69:3.1478225707669836)193:4.51084321761406,9:0.06689873408104319)252:1.0753176235927313,(46:5.575525852850966,(27:2.662084239556883,45:5.143190816456887)244:0.28624885489408314)250:1.355624413222806)266:1.8023790047700956)282:0.6277226286417843,6:1.6117891195856515)285:0.5824927264621351)287:0.24993477834870959,5:0.7054336789964992)288:0.7055542117339542)289:4.904733065892444,2:0.510322550722897)291:1.373151788242474)292:1.1643510518566984,(0:0.3713711429758888,(((7:0.5202018519739298,(((110:6.839100252405501,53:1.3126289229055033)187:5.284838749422818,((89:4.961723806929314,((105:1.7831483226932079,(125:1.6484547793898194,132:2.757732123389818)148:3.3711462210033893)155:2.1748099157112293,(137:4.730722313269723,119:1.175780458869724)149:5.111372446634714)170:3.1855999873248777)199:2.5306942732342534,(58:1.857693587966132,107:6.263649787166134)190:3.481072355397437)229:1.4387931848647497)253:1.9566409666481661,(((((114:11.031707611566553,((82:0.6802601814067799,(145:20.363284235811623,85:0.3196119486116231)158:0.4535859913951583)162:0.9374970556951325,92:2.4513639017019173)173:4.975615151864638)224:0.5885557387334259,64:6.096273991899977)232:0.005077092182744991,22:1.5627638405827255)233:0.677217537964367,(128:3.03287672688516,138:6.253338690085162)150:10.724825175361929)242:0.17299674355121653,(11:0.16599950018364495,(99:3.9652997422443867,((131:4.8766211242728374,122:3.3660132562728364)153:4.031041143263202,144:21.45681316243604)177:0.15078402100834865)180:4.727038970739258)228:1.0076906469146607)247:2.474671377378179)271:0.13960432289744773)273:0.33034153105901964,((((70:5.598567549506498,23:0.7918843030064977)222:0.7101092759583878,(25:0.7295703136663434,(39:0.33252175119464056,75:3.173299359994644)189:2.6296881301717008)217:0.8838202507985429)230:0.4495772456887366,((104:2.57101254430809,88:0.5572952265080886)159:1.5356555504562195,84:1.8501597209643137)175:5.766627171089311)238:1.960701008068284,(94:10.304271578480702,(44:1.1346869914823046,57:2.150838704782302)194:5.034564408398396)258:0.5103641030412049)264:1.4497537332110468)276:6.004720202690827,3:0.1738422997237805)290:3.7641288117521086)293:0.22931548954618108)294:0.0;"/>

  <state>
        <stateNode spec="RealParameter" id="volz.n_S0" value="999"/>
        <stateNode spec="RealParameter" id="volz.beta" value="0.00075"/>
        <stateNode spec="RealParameter" id="volz.gamma" value="0.30"/>
        <stateNode spec="RealParameter" id="volz.origin" value="53.8266687514"/>
    </state>

    <!-- Parameter priors -->
    <input spec='CompoundDistribution' id='parameterPriors'>
        <distribution spec='beast.math.distributions.Prior' x="@volz.n_S0">
            <distr spec='LogNormalDistributionModel' M="2" S="2"/>
        </distribution>
        <distribution spec='beast.math.distributions.Prior' x="@volz.beta">
            <distr spec="LogNormalDistributionModel"  M="-2" S="2"/>
        </distribution>
        <distribution spec='beast.math.distributions.Prior' x="@volz.gamma">
            <distr spec='LogNormalDistributionModel' M="0" S="2"/>
        </distribution>
        <distribution spec='beast.math.distributions.Prior' x="@volz.origin">
            <distr spec="LogNormalDistributionModel"  M="0" S="2"/>
        </distribution>
    </input>


    <run spec="MCMC" id="mcmc" chainLength="2000000">

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution id="coalescent" spec="Coalescent">
                <treeIntervals spec='TreeIntervals' id='treeIntervals'>
                    <tree idref="tree"/>
                </treeIntervals>
                
                <populationModel spec="SIRPopulationFunction" id='popFunc'>
                    <volzSIR spec="VolzSIR" id="volzSIR" integrationStepCount="1001">
                        <beta idref="volz.beta"/>
                        <gamma idref="volz.gamma"/>
                        <n_S0 idref="volz.n_S0"/>
                        <origin idref="volz.origin"/>
                    </volzSIR>
                </populationModel>
                
            </distribution>
        </distribution>


    <!-- OPERATORS! :D -->

      <operator id='S0' spec='ScaleOperator' scaleFactor="0.8" weight="1">
          <parameter idref="volz.n_S0"/>
      </operator>

      <operator id='beta' spec='ScaleOperator' scaleFactor="0.8" weight="1">
          <parameter idref="volz.beta"/>
      </operator>

      <operator id='gamma' spec='ScaleOperator' scaleFactor="0.8" weight="1">
          <parameter idref="volz.gamma"/>
       </operator>


        <logger logEvery="100" fileName="Volz2012_stochCoal_gammaS0_41.log">
   	        <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="volz.n_S0"/>
            <log idref="volz.beta"/>
            <log idref="volz.gamma"/>
            <log idref="volz.origin"/>
            <log idref="volzSIR"/>
        </logger>

        <logger logEvery="100">
            <model idref='posterior'/>
            <log idref="posterior"/>
            <log idref="volz.n_S0"/>
            <log idref="volz.beta"/>
            <log idref="volz.gamma"/>
            <log idref="volz.origin"/>
            <log idref="volzSIR"/>
        </logger>

    </run>

</beast>

